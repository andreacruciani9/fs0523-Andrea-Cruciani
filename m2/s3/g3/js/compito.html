<!DOCTYPE html>
<html lang="en">
      <head>
            <meta charset="UTF-8" />
            <meta
                  name="viewport"
                  content="width=device-width, initial-scale=1.0"
            />
            <title>Document</title>
            <link
                  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
                  rel="stylesheet"
                  integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
                  crossorigin="anonymous"
            />
      </head>
      <body>
            <div class="container bg-dark">
                  <div class="row" id="target">
                        <div class="col-12 col-md-6 col-3"></div>
                  </div>
            </div>

            <template>
                  <div class="col-md-6 col-3">
                        <div class="card">
                              <img src="" class="card-img-top" alt="..." />
                              <div class="card-body">
                                    <h5 class="card-title">Card title</h5>
                                    <p class="card-text">
                                          Some quick example text to build on
                                          the card title and make up the bulk of
                                          the card's content.
                                    </p>
                              </div>
                              <ul class="list-group list-group-flush">
                                    <li class="list-group-item card-price">
                                          prezzo:
                                    </li>
                              </ul>
                              <div class="card-body">
                                    <button class="btn btn-primary addToCard">
                                          add to card
                                    </button>
                              </div>
                        </div>
                  </div>
            </template>
            <script>
                  let cartsStorage = localStorage.getItem("cart");
                  let cartArrey = cartsStorage ? JSON.parse(cartsStorage) : [];
                  console.log(cartArrey);
                  fetch("https://striveschool-api.herokuapp.com/books")
                        .then((res) => res.json())
                        .then((libri) => {
                              let target = document.querySelector("#target");

                              libri.forEach((libro) => {
                                    let clone = getCartClone();
                                    console.log(clone);
                                    let img =
                                          clone.querySelector(".card-img-top");
                                    let title =
                                          clone.querySelector(".card-title");
                                    let price =
                                          clone.querySelector(".card-price");

                                    img.src = libro.img;
                                    title.innerText = libro.title;
                                    price.innerText = libro.price;
                                    let taddToCard =
                                          clone.queryselector(".addToCard");
                                    target.append(clone);
                                    addToCard.addEventListener("click", () => {
                                          cartArrey.push(libro);
                                          localStorage.setItem(
                                                "card",
                                                JSON.stringify(cartArrey)
                                          );
                                    });
                                    console.log(target);
                              });
                        });
                  function getCartClone() {
                        let temp = document.getElementsByTagName("template")[0];
                        return temp.content.cloneNode(true);
                  }
            </script>
      </body>
</html>
